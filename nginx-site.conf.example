
# map $http_upgrade $connection_upgrade {
#     default upgrade;
#     ''      close;
# }
# 
# server {
# 	listen 80;
# 	listen [::]:80;
# 	server_name zpl.home.lab;
# 	rewrite ^(.*) https://$host$1 permanent;
# }
# 

server {
	listen 80;
	# listen 443 ssl;
	# listen [::]:443;

	root /var/www/html;

	access_log /var/log/nginx/zpl-access.log;
	server_name zpl.home.lab;

	client_max_body_size 10M;
	auth_basic           "Restricted Area";
    	auth_basic_user_file /etc/apache2/.htpasswd;


	# ssl_certificate /etc/ssl/private/wildcard.home.lab.crt;
	# ssl_certificate_key /etc/ssl/private/wildcard.home.lab.key;
	# ssl_protocols TLSv1.2;
	# ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;
	# ssl_prefer_server_ciphers on;

	location /convert {
		if ( $request_method != POST ) {
			return 405;
		}
	      fastcgi_param REQUEST_METHOD  $request_method;
	      fastcgi_param CONTENT_TYPE    $content_type;

	      fastcgi_pass unix:/tmp/converter/fcgi.sock;
	}
}
